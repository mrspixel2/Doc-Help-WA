{"ast":null,"code":"var _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n/* tslint:disable:member-ordering interface-name */\n\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Editor, EditorState, ContentState, CompositeDecorator, Modifier, getDefaultKeyBinding, KeyBindingUtil, DefaultDraftBlockRenderMap } from 'draft-js';\nimport { List, Map } from 'immutable';\nimport 'setimmediate';\nimport classnames from 'classnames';\nimport { createToolbar } from '../Toolbar';\nimport ConfigStore from './ConfigStore';\nimport GetHTML from './export/getHTML';\nimport exportText, { decodeContent } from './export/exportText';\nimport customHTML2Content from './customHTML2Content';\nvar hasCommandModifier = KeyBindingUtil.hasCommandModifier;\n\nfunction noop() {}\n\n;\nvar defaultPluginConfig = {};\nvar focusDummyStyle = {\n  width: 0,\n  opacity: 0,\n  border: 0,\n  position: 'absolute',\n  left: 0,\n  top: 0\n};\nvar toolbar = createToolbar();\nvar configStore = new ConfigStore();\n\nvar EditorCore = function (_React$Component) {\n  _inherits(EditorCore, _React$Component);\n\n  function EditorCore(props) {\n    _classCallCheck(this, EditorCore);\n\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n    _this.cancelForceUpdateImmediate = function () {\n      clearImmediate(_this.forceUpdateImmediate);\n      _this.forceUpdateImmediate = null;\n    };\n\n    _this.handlePastedText = function (text, html) {\n      var editorState = _this.state.editorState;\n\n      if (html) {\n        var contentState = editorState.getCurrentContent();\n        var selection = editorState.getSelection();\n        var fragment = customHTML2Content(html, contentState);\n        var pastedContent = Modifier.replaceWithFragment(contentState, selection, fragment);\n        var newContent = pastedContent.merge({\n          selectionBefore: selection,\n          selectionAfter: pastedContent.getSelectionAfter().set('hasFocus', true)\n        });\n\n        _this.setEditorState(EditorState.push(editorState, newContent, 'insert-fragment'), true);\n\n        return 'handled';\n      }\n\n      return 'not-handled';\n    };\n\n    _this.plugins = List(List(props.plugins).flatten(true));\n    var editorState = void 0;\n\n    if (props.value !== undefined) {\n      if (props.value instanceof EditorState) {\n        editorState = props.value || EditorState.createEmpty();\n      } else {\n        editorState = EditorState.createEmpty();\n      }\n    } else {\n      editorState = EditorState.createEmpty();\n    }\n\n    editorState = _this.generatorDefaultValue(editorState);\n    _this.state = {\n      plugins: _this.reloadPlugins(),\n      editorState: editorState,\n      customStyleMap: {},\n      customBlockStyleMap: {},\n      compositeDecorator: null\n    };\n\n    if (props.value !== undefined) {\n      _this.controlledMode = true;\n    }\n\n    return _this;\n  }\n\n  EditorCore.ToEditorState = function ToEditorState(text) {\n    var createEmptyContentState = ContentState.createFromText(decodeContent(text) || '');\n    var editorState = EditorState.createWithContent(createEmptyContentState);\n    return EditorState.forceSelection(editorState, createEmptyContentState.getSelectionAfter());\n  };\n\n  EditorCore.prototype.getDefaultValue = function getDefaultValue() {\n    var _props = this.props,\n        defaultValue = _props.defaultValue,\n        value = _props.value;\n    return value || defaultValue;\n  };\n\n  EditorCore.prototype.Reset = function Reset() {\n    var defaultValue = this.getDefaultValue();\n    var contentState = defaultValue ? defaultValue.getCurrentContent() : ContentState.createFromText('');\n    var updatedEditorState = EditorState.push(this.state.editorState, contentState, 'remove-range');\n    this.setEditorState(EditorState.forceSelection(updatedEditorState, contentState.getSelectionBefore()));\n  };\n\n  EditorCore.prototype.SetText = function SetText(text) {\n    var createTextContentState = ContentState.createFromText(text || '');\n    var editorState = EditorState.push(this.state.editorState, createTextContentState, 'change-block-data');\n    this.setEditorState(EditorState.moveFocusToEnd(editorState), true);\n  };\n\n  EditorCore.prototype.getChildContext = function getChildContext() {\n    return {\n      getEditorState: this.getEditorState,\n      setEditorState: this.setEditorState\n    };\n  };\n\n  EditorCore.prototype.reloadPlugins = function reloadPlugins() {\n    var _this2 = this;\n\n    return this.plugins && this.plugins.size ? this.plugins.map(function (plugin) {\n      // 如果插件有 callbacks 方法,则认为插件已经加载。\n      if (plugin.callbacks) {\n        return plugin;\n      } // 如果插件有 constructor 方法,则构造插件\n\n\n      if (plugin.hasOwnProperty('constructor')) {\n        var pluginConfig = _extends(_this2.props.pluginConfig, plugin.config || {}, defaultPluginConfig);\n\n        return plugin.constructor(pluginConfig);\n      } // else 无效插件\n\n\n      console.warn('>> 插件: [', plugin.name, '] 无效。插件或许已经过期。');\n      return false;\n    }).filter(function (plugin) {\n      return plugin;\n    }).toArray() : [];\n  };\n\n  EditorCore.prototype.componentWillMount = function componentWillMount() {\n    var plugins = this.initPlugins().concat([toolbar]);\n    var customStyleMap = {};\n    var customBlockStyleMap = {};\n    var customBlockRenderMap = Map(DefaultDraftBlockRenderMap);\n    var toHTMLList = List([]); // initialize compositeDecorator\n\n    var compositeDecorator = new CompositeDecorator(plugins.filter(function (plugin) {\n      return plugin.decorators !== undefined;\n    }).map(function (plugin) {\n      return plugin.decorators;\n    }).reduce(function (prev, curr) {\n      return prev.concat(curr);\n    }, [])); // initialize Toolbar\n\n    var toolbarPlugins = List(plugins.filter(function (plugin) {\n      return !!plugin.component && plugin.name !== 'toolbar';\n    })); // load inline styles...\n\n    plugins.forEach(function (plugin) {\n      var styleMap = plugin.styleMap,\n          blockStyleMap = plugin.blockStyleMap,\n          blockRenderMap = plugin.blockRenderMap,\n          toHtml = plugin.toHtml;\n\n      if (styleMap) {\n        for (var key in styleMap) {\n          if (styleMap.hasOwnProperty(key)) {\n            customStyleMap[key] = styleMap[key];\n          }\n        }\n      }\n\n      if (blockStyleMap) {\n        for (var _key in blockStyleMap) {\n          if (blockStyleMap.hasOwnProperty(_key)) {\n            customBlockStyleMap[_key] = blockStyleMap[_key];\n            customBlockRenderMap = customBlockRenderMap.set(_key, {\n              element: null\n            });\n          }\n        }\n      }\n\n      if (toHtml) {\n        toHTMLList = toHTMLList.push(toHtml);\n      }\n\n      if (blockRenderMap) {\n        for (var _key2 in blockRenderMap) {\n          if (blockRenderMap.hasOwnProperty(_key2)) {\n            customBlockRenderMap = customBlockRenderMap.set(_key2, blockRenderMap[_key2]);\n          }\n        }\n      }\n    });\n    configStore.set('customStyleMap', customStyleMap);\n    configStore.set('customBlockStyleMap', customBlockStyleMap);\n    configStore.set('blockRenderMap', customBlockRenderMap);\n    configStore.set('customStyleFn', this.customStyleFn.bind(this));\n    configStore.set('toHTMLList', toHTMLList);\n    this.setState({\n      toolbarPlugins: toolbarPlugins,\n      compositeDecorator: compositeDecorator\n    });\n    this.setEditorState(EditorState.set(this.state.editorState, {\n      decorator: compositeDecorator\n    }), false, false);\n  };\n\n  EditorCore.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n    if (this.forceUpdateImmediate) {\n      this.cancelForceUpdateImmediate();\n    }\n\n    if (this.controlledMode) {\n      var decorators = nextProps.value.getDecorator();\n      var editorState = decorators ? nextProps.value : EditorState.set(nextProps.value, {\n        decorator: this.state.compositeDecorator\n      });\n      this.setState({\n        editorState: editorState\n      });\n    }\n  };\n\n  EditorCore.prototype.componentWillUnmount = function componentWillUnmount() {\n    this.cancelForceUpdateImmediate();\n  }; // 处理 value\n\n\n  EditorCore.prototype.generatorDefaultValue = function generatorDefaultValue(editorState) {\n    var defaultValue = this.getDefaultValue();\n\n    if (defaultValue) {\n      return defaultValue;\n    }\n\n    return editorState;\n  };\n\n  EditorCore.prototype.getStyleMap = function getStyleMap() {\n    return configStore.get('customStyleMap');\n  };\n\n  EditorCore.prototype.setStyleMap = function setStyleMap(customStyleMap) {\n    configStore.set('customStyleMap', customStyleMap);\n    this.render();\n  };\n\n  EditorCore.prototype.initPlugins = function initPlugins() {\n    var _this3 = this;\n\n    var enableCallbacks = ['focus', 'getEditorState', 'setEditorState', 'getStyleMap', 'setStyleMap'];\n    return this.getPlugins().map(function (plugin) {\n      enableCallbacks.forEach(function (callbackName) {\n        if (plugin.callbacks.hasOwnProperty(callbackName)) {\n          plugin.callbacks[callbackName] = _this3[callbackName].bind(_this3);\n        }\n      });\n      return plugin;\n    });\n  };\n\n  EditorCore.prototype.focusEditor = function focusEditor(ev) {\n    this.refs.editor.focus(ev);\n\n    if (this.props.readOnly) {\n      this._focusDummy.focus();\n    }\n\n    if (this.props.onFocus) {\n      this.props.onFocus(ev);\n    }\n  };\n\n  EditorCore.prototype._focus = function _focus(ev) {\n    if (!ev || !ev.nativeEvent || !ev.nativeEvent.target) {\n      return;\n    }\n\n    if (document.activeElement && document.activeElement.getAttribute('contenteditable') === 'true') {\n      return;\n    }\n\n    return this.focus(ev);\n  };\n\n  EditorCore.prototype.focus = function focus(ev) {\n    var _this4 = this;\n\n    var event = ev && ev.nativeEvent;\n\n    if (event && event.target === this._editorWrapper) {\n      var editorState = this.state.editorState;\n      var selection = editorState.getSelection();\n\n      if (!selection.getHasFocus()) {\n        if (selection.isCollapsed()) {\n          return this.setState({\n            editorState: EditorState.moveSelectionToEnd(editorState)\n          }, function () {\n            _this4.focusEditor(ev);\n          });\n        }\n      }\n    }\n\n    this.focusEditor(ev);\n  };\n\n  EditorCore.prototype.getPlugins = function getPlugins() {\n    return this.state.plugins.slice();\n  };\n\n  EditorCore.prototype.getEventHandler = function getEventHandler() {\n    var _this5 = this;\n\n    var enabledEvents = ['onUpArrow', 'onDownArrow', 'handleReturn', 'onFocus', 'onBlur', 'onTab', 'handlePastedText'];\n    var eventHandler = {};\n    enabledEvents.forEach(function (event) {\n      eventHandler[event] = _this5.generatorEventHandler(event);\n    });\n    return eventHandler;\n  };\n\n  EditorCore.prototype.getEditorState = function getEditorState() {\n    var needFocus = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    if (needFocus) {\n      this.refs.editor.focus();\n    }\n\n    return this.state.editorState;\n  };\n\n  EditorCore.prototype.setEditorState = function setEditorState(editorState) {\n    var _this6 = this;\n\n    var focusEditor = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    var triggerChange = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    var newEditorState = editorState;\n    this.getPlugins().forEach(function (plugin) {\n      if (plugin.onChange) {\n        var updatedEditorState = plugin.onChange(newEditorState);\n\n        if (updatedEditorState) {\n          newEditorState = updatedEditorState;\n        }\n      }\n    });\n\n    if (this.props.onChange && triggerChange) {\n      this.props.onChange(newEditorState); // close this issue https://github.com/ant-design/ant-design/issues/5788\n      // when onChange not take any effect\n      // `<Editor />` won't rerender cause no props is changed.\n      // add an timeout here,\n      // if props.onChange not trigger componentWillReceiveProps,\n      // we will force render Editor with previous editorState,\n\n      if (this.controlledMode) {\n        this.forceUpdateImmediate = setImmediate(function () {\n          return _this6.setState({\n            editorState: new EditorState(_this6.state.editorState.getImmutable())\n          });\n        });\n      }\n    }\n\n    if (!this.controlledMode) {\n      this.setState({\n        editorState: newEditorState\n      }, focusEditor ? function () {\n        return setImmediate(function () {\n          return _this6.refs.editor.focus();\n        });\n      } : noop);\n    }\n  };\n\n  EditorCore.prototype.handleKeyBinding = function handleKeyBinding(ev) {\n    if (this.props.onKeyDown) {\n      ev.ctrlKey = hasCommandModifier(ev);\n      var keyDownResult = this.props.onKeyDown(ev);\n\n      if (keyDownResult) {\n        return keyDownResult;\n      }\n\n      return getDefaultKeyBinding(ev);\n    }\n\n    return getDefaultKeyBinding(ev);\n  };\n\n  EditorCore.prototype.handleKeyCommand = function handleKeyCommand(command) {\n    if (this.props.multiLines) {\n      return this.eventHandle('handleKeyBinding', command);\n    }\n\n    return command === 'split-block' ? 'handled' : 'not-handled';\n  };\n\n  EditorCore.prototype.getBlockStyle = function getBlockStyle(contentBlock) {\n    var customBlockStyleMap = configStore.get('customBlockStyleMap');\n    var type = contentBlock.getType();\n\n    if (customBlockStyleMap.hasOwnProperty(type)) {\n      return customBlockStyleMap[type];\n    }\n\n    return '';\n  };\n\n  EditorCore.prototype.blockRendererFn = function blockRendererFn(contentBlock) {\n    var blockRenderResult = null;\n    this.getPlugins().forEach(function (plugin) {\n      if (plugin.blockRendererFn) {\n        var result = plugin.blockRendererFn(contentBlock);\n\n        if (result) {\n          blockRenderResult = result;\n        }\n      }\n    });\n    return blockRenderResult;\n  };\n\n  EditorCore.prototype.eventHandle = function eventHandle(eventName) {\n    var _props2;\n\n    var plugins = this.getPlugins();\n\n    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key3 = 1; _key3 < _len; _key3++) {\n      args[_key3 - 1] = arguments[_key3];\n    }\n\n    for (var i = 0; i < plugins.length; i++) {\n      var plugin = plugins[i];\n\n      if (plugin.callbacks[eventName] && typeof plugin.callbacks[eventName] === 'function') {\n        var _plugin$callbacks;\n\n        var result = (_plugin$callbacks = plugin.callbacks)[eventName].apply(_plugin$callbacks, args);\n\n        if (result === true) {\n          return 'handled';\n        }\n      }\n    }\n\n    return this.props.hasOwnProperty(eventName) && (_props2 = this.props)[eventName].apply(_props2, args) === true ? 'handled' : 'not-handled';\n  };\n\n  EditorCore.prototype.generatorEventHandler = function generatorEventHandler(eventName) {\n    var _this7 = this;\n\n    return function () {\n      for (var _len2 = arguments.length, args = Array(_len2), _key4 = 0; _key4 < _len2; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n\n      return _this7.eventHandle.apply(_this7, [eventName].concat(args));\n    };\n  };\n\n  EditorCore.prototype.customStyleFn = function customStyleFn(styleSet) {\n    if (styleSet.size === 0) {\n      return {};\n    }\n\n    var plugins = this.getPlugins();\n    var resultStyle = {};\n\n    for (var i = 0; i < plugins.length; i++) {\n      if (plugins[i].customStyleFn) {\n        var styled = plugins[i].customStyleFn(styleSet);\n\n        if (styled) {\n          _extends(resultStyle, styled);\n        }\n      }\n    }\n\n    return resultStyle;\n  };\n\n  EditorCore.prototype.render = function render() {\n    var _classnames,\n        _this8 = this;\n\n    var _props3 = this.props,\n        prefixCls = _props3.prefixCls,\n        toolbars = _props3.toolbars,\n        style = _props3.style,\n        readOnly = _props3.readOnly,\n        multiLines = _props3.multiLines;\n    var _state = this.state,\n        editorState = _state.editorState,\n        toolbarPlugins = _state.toolbarPlugins;\n    var customStyleMap = configStore.get('customStyleMap');\n    var blockRenderMap = configStore.get('blockRenderMap');\n    var eventHandler = this.getEventHandler();\n    var Toolbar = toolbar.component;\n    var cls = classnames((_classnames = {}, _classnames[prefixCls + '-editor'] = true, _classnames.readonly = readOnly, _classnames.oneline = !multiLines, _classnames));\n    return React.createElement('div', {\n      style: style,\n      className: cls,\n      onClick: this._focus.bind(this)\n    }, React.createElement(Toolbar, {\n      editorState: editorState,\n      prefixCls: prefixCls,\n      className: prefixCls + '-toolbar',\n      plugins: toolbarPlugins,\n      toolbars: toolbars\n    }), React.createElement('div', {\n      className: prefixCls + '-editor-wrapper',\n      ref: function ref(ele) {\n        return _this8._editorWrapper = ele;\n      },\n      style: style,\n      onClick: function onClick(ev) {\n        return ev.preventDefault();\n      }\n    }, React.createElement(Editor, _extends({}, this.props, eventHandler, {\n      ref: 'editor',\n      customStyleMap: customStyleMap,\n      customStyleFn: this.customStyleFn.bind(this),\n      editorState: editorState,\n      handleKeyCommand: this.handleKeyCommand.bind(this),\n      keyBindingFn: this.handleKeyBinding.bind(this),\n      onChange: this.setEditorState.bind(this),\n      blockStyleFn: this.getBlockStyle.bind(this),\n      blockRenderMap: blockRenderMap,\n      handlePastedText: this.handlePastedText,\n      blockRendererFn: this.blockRendererFn.bind(this)\n    })), readOnly ? React.createElement('input', {\n      style: focusDummyStyle,\n      ref: function ref(ele) {\n        return _this8._focusDummy = ele;\n      },\n      onBlur: eventHandler.onBlur\n    }) : null, this.props.children));\n  };\n\n  return EditorCore;\n}(React.Component);\n\nEditorCore.GetText = exportText;\nEditorCore.GetHTML = GetHTML(configStore);\nEditorCore.defaultProps = {\n  multiLines: true,\n  plugins: [],\n  prefixCls: 'rc-editor-core',\n  pluginConfig: {},\n  toolbars: [],\n  spilitLine: 'enter'\n};\nEditorCore.childContextTypes = {\n  getEditorState: PropTypes.func,\n  setEditorState: PropTypes.func\n};\nexport default EditorCore;","map":{"version":3,"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","React","PropTypes","Editor","EditorState","ContentState","CompositeDecorator","Modifier","getDefaultKeyBinding","KeyBindingUtil","DefaultDraftBlockRenderMap","List","Map","classnames","createToolbar","ConfigStore","GetHTML","exportText","decodeContent","customHTML2Content","hasCommandModifier","noop","defaultPluginConfig","focusDummyStyle","width","opacity","border","position","left","top","toolbar","configStore","EditorCore","_React$Component","props","_this","cancelForceUpdateImmediate","clearImmediate","forceUpdateImmediate","handlePastedText","text","html","editorState","state","contentState","getCurrentContent","selection","getSelection","fragment","pastedContent","replaceWithFragment","newContent","merge","selectionBefore","selectionAfter","getSelectionAfter","set","setEditorState","push","plugins","flatten","undefined","createEmpty","generatorDefaultValue","reloadPlugins","customStyleMap","customBlockStyleMap","compositeDecorator","controlledMode","ToEditorState","createEmptyContentState","createFromText","createWithContent","forceSelection","getDefaultValue","_props","defaultValue","Reset","updatedEditorState","getSelectionBefore","SetText","createTextContentState","moveFocusToEnd","getChildContext","getEditorState","_this2","size","map","plugin","callbacks","pluginConfig","config","console","warn","name","filter","toArray","componentWillMount","initPlugins","concat","customBlockRenderMap","toHTMLList","decorators","reduce","prev","curr","toolbarPlugins","component","forEach","styleMap","blockStyleMap","blockRenderMap","toHtml","_key","element","_key2","customStyleFn","bind","setState","decorator","componentWillReceiveProps","nextProps","getDecorator","componentWillUnmount","getStyleMap","get","setStyleMap","render","_this3","enableCallbacks","getPlugins","callbackName","focusEditor","ev","refs","editor","focus","readOnly","_focusDummy","onFocus","_focus","nativeEvent","document","activeElement","getAttribute","_this4","event","_editorWrapper","getHasFocus","isCollapsed","moveSelectionToEnd","slice","getEventHandler","_this5","enabledEvents","eventHandler","generatorEventHandler","needFocus","_this6","triggerChange","newEditorState","onChange","setImmediate","getImmutable","handleKeyBinding","onKeyDown","ctrlKey","keyDownResult","handleKeyCommand","command","multiLines","eventHandle","getBlockStyle","contentBlock","type","getType","blockRendererFn","blockRenderResult","result","eventName","_props2","_len","args","Array","_key3","_plugin$callbacks","apply","_this7","_len2","_key4","styleSet","resultStyle","styled","_classnames","_this8","_props3","prefixCls","toolbars","style","_state","Toolbar","cls","readonly","oneline","createElement","className","onClick","ref","ele","preventDefault","keyBindingFn","blockStyleFn","onBlur","children","Component","GetText","defaultProps","spilitLine","childContextTypes","func"],"sources":["E:/Work/PFE/Project folder/DocHelp-WA/node_modules/rc-editor-core/es/EditorCore/index.js"],"sourcesContent":["var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/* tslint:disable:member-ordering interface-name */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Editor, EditorState, ContentState, CompositeDecorator, Modifier, getDefaultKeyBinding, KeyBindingUtil, DefaultDraftBlockRenderMap } from 'draft-js';\nimport { List, Map } from 'immutable';\nimport 'setimmediate';\nimport classnames from 'classnames';\nimport { createToolbar } from '../Toolbar';\nimport ConfigStore from './ConfigStore';\nimport GetHTML from './export/getHTML';\nimport exportText, { decodeContent } from './export/exportText';\nimport customHTML2Content from './customHTML2Content';\nvar hasCommandModifier = KeyBindingUtil.hasCommandModifier;\n\nfunction noop() {}\n;\nvar defaultPluginConfig = {};\nvar focusDummyStyle = {\n    width: 0,\n    opacity: 0,\n    border: 0,\n    position: 'absolute',\n    left: 0,\n    top: 0\n};\nvar toolbar = createToolbar();\nvar configStore = new ConfigStore();\n\nvar EditorCore = function (_React$Component) {\n    _inherits(EditorCore, _React$Component);\n\n    function EditorCore(props) {\n        _classCallCheck(this, EditorCore);\n\n        var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n        _this.cancelForceUpdateImmediate = function () {\n            clearImmediate(_this.forceUpdateImmediate);\n            _this.forceUpdateImmediate = null;\n        };\n        _this.handlePastedText = function (text, html) {\n            var editorState = _this.state.editorState;\n\n            if (html) {\n                var contentState = editorState.getCurrentContent();\n                var selection = editorState.getSelection();\n                var fragment = customHTML2Content(html, contentState);\n                var pastedContent = Modifier.replaceWithFragment(contentState, selection, fragment);\n                var newContent = pastedContent.merge({\n                    selectionBefore: selection,\n                    selectionAfter: pastedContent.getSelectionAfter().set('hasFocus', true)\n                });\n                _this.setEditorState(EditorState.push(editorState, newContent, 'insert-fragment'), true);\n                return 'handled';\n            }\n            return 'not-handled';\n        };\n        _this.plugins = List(List(props.plugins).flatten(true));\n        var editorState = void 0;\n        if (props.value !== undefined) {\n            if (props.value instanceof EditorState) {\n                editorState = props.value || EditorState.createEmpty();\n            } else {\n                editorState = EditorState.createEmpty();\n            }\n        } else {\n            editorState = EditorState.createEmpty();\n        }\n        editorState = _this.generatorDefaultValue(editorState);\n        _this.state = {\n            plugins: _this.reloadPlugins(),\n            editorState: editorState,\n            customStyleMap: {},\n            customBlockStyleMap: {},\n            compositeDecorator: null\n        };\n        if (props.value !== undefined) {\n            _this.controlledMode = true;\n        }\n        return _this;\n    }\n\n    EditorCore.ToEditorState = function ToEditorState(text) {\n        var createEmptyContentState = ContentState.createFromText(decodeContent(text) || '');\n        var editorState = EditorState.createWithContent(createEmptyContentState);\n        return EditorState.forceSelection(editorState, createEmptyContentState.getSelectionAfter());\n    };\n\n    EditorCore.prototype.getDefaultValue = function getDefaultValue() {\n        var _props = this.props,\n            defaultValue = _props.defaultValue,\n            value = _props.value;\n\n        return value || defaultValue;\n    };\n\n    EditorCore.prototype.Reset = function Reset() {\n        var defaultValue = this.getDefaultValue();\n        var contentState = defaultValue ? defaultValue.getCurrentContent() : ContentState.createFromText('');\n        var updatedEditorState = EditorState.push(this.state.editorState, contentState, 'remove-range');\n        this.setEditorState(EditorState.forceSelection(updatedEditorState, contentState.getSelectionBefore()));\n    };\n\n    EditorCore.prototype.SetText = function SetText(text) {\n        var createTextContentState = ContentState.createFromText(text || '');\n        var editorState = EditorState.push(this.state.editorState, createTextContentState, 'change-block-data');\n        this.setEditorState(EditorState.moveFocusToEnd(editorState), true);\n    };\n\n    EditorCore.prototype.getChildContext = function getChildContext() {\n        return {\n            getEditorState: this.getEditorState,\n            setEditorState: this.setEditorState\n        };\n    };\n\n    EditorCore.prototype.reloadPlugins = function reloadPlugins() {\n        var _this2 = this;\n\n        return this.plugins && this.plugins.size ? this.plugins.map(function (plugin) {\n            // 如果插件有 callbacks 方法,则认为插件已经加载。\n            if (plugin.callbacks) {\n                return plugin;\n            }\n            // 如果插件有 constructor 方法,则构造插件\n            if (plugin.hasOwnProperty('constructor')) {\n                var pluginConfig = _extends(_this2.props.pluginConfig, plugin.config || {}, defaultPluginConfig);\n                return plugin.constructor(pluginConfig);\n            }\n            // else 无效插件\n            console.warn('>> 插件: [', plugin.name, '] 无效。插件或许已经过期。');\n            return false;\n        }).filter(function (plugin) {\n            return plugin;\n        }).toArray() : [];\n    };\n\n    EditorCore.prototype.componentWillMount = function componentWillMount() {\n        var plugins = this.initPlugins().concat([toolbar]);\n        var customStyleMap = {};\n        var customBlockStyleMap = {};\n        var customBlockRenderMap = Map(DefaultDraftBlockRenderMap);\n        var toHTMLList = List([]);\n        // initialize compositeDecorator\n        var compositeDecorator = new CompositeDecorator(plugins.filter(function (plugin) {\n            return plugin.decorators !== undefined;\n        }).map(function (plugin) {\n            return plugin.decorators;\n        }).reduce(function (prev, curr) {\n            return prev.concat(curr);\n        }, []));\n        // initialize Toolbar\n        var toolbarPlugins = List(plugins.filter(function (plugin) {\n            return !!plugin.component && plugin.name !== 'toolbar';\n        }));\n        // load inline styles...\n        plugins.forEach(function (plugin) {\n            var styleMap = plugin.styleMap,\n                blockStyleMap = plugin.blockStyleMap,\n                blockRenderMap = plugin.blockRenderMap,\n                toHtml = plugin.toHtml;\n\n            if (styleMap) {\n                for (var key in styleMap) {\n                    if (styleMap.hasOwnProperty(key)) {\n                        customStyleMap[key] = styleMap[key];\n                    }\n                }\n            }\n            if (blockStyleMap) {\n                for (var _key in blockStyleMap) {\n                    if (blockStyleMap.hasOwnProperty(_key)) {\n                        customBlockStyleMap[_key] = blockStyleMap[_key];\n                        customBlockRenderMap = customBlockRenderMap.set(_key, {\n                            element: null\n                        });\n                    }\n                }\n            }\n            if (toHtml) {\n                toHTMLList = toHTMLList.push(toHtml);\n            }\n            if (blockRenderMap) {\n                for (var _key2 in blockRenderMap) {\n                    if (blockRenderMap.hasOwnProperty(_key2)) {\n                        customBlockRenderMap = customBlockRenderMap.set(_key2, blockRenderMap[_key2]);\n                    }\n                }\n            }\n        });\n        configStore.set('customStyleMap', customStyleMap);\n        configStore.set('customBlockStyleMap', customBlockStyleMap);\n        configStore.set('blockRenderMap', customBlockRenderMap);\n        configStore.set('customStyleFn', this.customStyleFn.bind(this));\n        configStore.set('toHTMLList', toHTMLList);\n        this.setState({\n            toolbarPlugins: toolbarPlugins,\n            compositeDecorator: compositeDecorator\n        });\n        this.setEditorState(EditorState.set(this.state.editorState, { decorator: compositeDecorator }), false, false);\n    };\n\n    EditorCore.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n        if (this.forceUpdateImmediate) {\n            this.cancelForceUpdateImmediate();\n        }\n        if (this.controlledMode) {\n            var decorators = nextProps.value.getDecorator();\n            var editorState = decorators ? nextProps.value : EditorState.set(nextProps.value, { decorator: this.state.compositeDecorator });\n            this.setState({\n                editorState: editorState\n            });\n        }\n    };\n\n    EditorCore.prototype.componentWillUnmount = function componentWillUnmount() {\n        this.cancelForceUpdateImmediate();\n    };\n    // 处理 value\n\n\n    EditorCore.prototype.generatorDefaultValue = function generatorDefaultValue(editorState) {\n        var defaultValue = this.getDefaultValue();\n        if (defaultValue) {\n            return defaultValue;\n        }\n        return editorState;\n    };\n\n    EditorCore.prototype.getStyleMap = function getStyleMap() {\n        return configStore.get('customStyleMap');\n    };\n\n    EditorCore.prototype.setStyleMap = function setStyleMap(customStyleMap) {\n        configStore.set('customStyleMap', customStyleMap);\n        this.render();\n    };\n\n    EditorCore.prototype.initPlugins = function initPlugins() {\n        var _this3 = this;\n\n        var enableCallbacks = ['focus', 'getEditorState', 'setEditorState', 'getStyleMap', 'setStyleMap'];\n        return this.getPlugins().map(function (plugin) {\n            enableCallbacks.forEach(function (callbackName) {\n                if (plugin.callbacks.hasOwnProperty(callbackName)) {\n                    plugin.callbacks[callbackName] = _this3[callbackName].bind(_this3);\n                }\n            });\n            return plugin;\n        });\n    };\n\n    EditorCore.prototype.focusEditor = function focusEditor(ev) {\n        this.refs.editor.focus(ev);\n        if (this.props.readOnly) {\n            this._focusDummy.focus();\n        }\n        if (this.props.onFocus) {\n            this.props.onFocus(ev);\n        }\n    };\n\n    EditorCore.prototype._focus = function _focus(ev) {\n        if (!ev || !ev.nativeEvent || !ev.nativeEvent.target) {\n            return;\n        }\n        if (document.activeElement && document.activeElement.getAttribute('contenteditable') === 'true') {\n            return;\n        }\n        return this.focus(ev);\n    };\n\n    EditorCore.prototype.focus = function focus(ev) {\n        var _this4 = this;\n\n        var event = ev && ev.nativeEvent;\n        if (event && event.target === this._editorWrapper) {\n            var editorState = this.state.editorState;\n\n            var selection = editorState.getSelection();\n            if (!selection.getHasFocus()) {\n                if (selection.isCollapsed()) {\n                    return this.setState({\n                        editorState: EditorState.moveSelectionToEnd(editorState)\n                    }, function () {\n                        _this4.focusEditor(ev);\n                    });\n                }\n            }\n        }\n        this.focusEditor(ev);\n    };\n\n    EditorCore.prototype.getPlugins = function getPlugins() {\n        return this.state.plugins.slice();\n    };\n\n    EditorCore.prototype.getEventHandler = function getEventHandler() {\n        var _this5 = this;\n\n        var enabledEvents = ['onUpArrow', 'onDownArrow', 'handleReturn', 'onFocus', 'onBlur', 'onTab', 'handlePastedText'];\n        var eventHandler = {};\n        enabledEvents.forEach(function (event) {\n            eventHandler[event] = _this5.generatorEventHandler(event);\n        });\n        return eventHandler;\n    };\n\n    EditorCore.prototype.getEditorState = function getEditorState() {\n        var needFocus = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n        if (needFocus) {\n            this.refs.editor.focus();\n        }\n        return this.state.editorState;\n    };\n\n    EditorCore.prototype.setEditorState = function setEditorState(editorState) {\n        var _this6 = this;\n\n        var focusEditor = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n        var triggerChange = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n        var newEditorState = editorState;\n        this.getPlugins().forEach(function (plugin) {\n            if (plugin.onChange) {\n                var updatedEditorState = plugin.onChange(newEditorState);\n                if (updatedEditorState) {\n                    newEditorState = updatedEditorState;\n                }\n            }\n        });\n        if (this.props.onChange && triggerChange) {\n            this.props.onChange(newEditorState);\n            // close this issue https://github.com/ant-design/ant-design/issues/5788\n            // when onChange not take any effect\n            // `<Editor />` won't rerender cause no props is changed.\n            // add an timeout here,\n            // if props.onChange not trigger componentWillReceiveProps,\n            // we will force render Editor with previous editorState,\n            if (this.controlledMode) {\n                this.forceUpdateImmediate = setImmediate(function () {\n                    return _this6.setState({\n                        editorState: new EditorState(_this6.state.editorState.getImmutable())\n                    });\n                });\n            }\n        }\n        if (!this.controlledMode) {\n            this.setState({ editorState: newEditorState }, focusEditor ? function () {\n                return setImmediate(function () {\n                    return _this6.refs.editor.focus();\n                });\n            } : noop);\n        }\n    };\n\n    EditorCore.prototype.handleKeyBinding = function handleKeyBinding(ev) {\n        if (this.props.onKeyDown) {\n            ev.ctrlKey = hasCommandModifier(ev);\n            var keyDownResult = this.props.onKeyDown(ev);\n            if (keyDownResult) {\n                return keyDownResult;\n            }\n            return getDefaultKeyBinding(ev);\n        }\n        return getDefaultKeyBinding(ev);\n    };\n\n    EditorCore.prototype.handleKeyCommand = function handleKeyCommand(command) {\n        if (this.props.multiLines) {\n            return this.eventHandle('handleKeyBinding', command);\n        }\n        return command === 'split-block' ? 'handled' : 'not-handled';\n    };\n\n    EditorCore.prototype.getBlockStyle = function getBlockStyle(contentBlock) {\n        var customBlockStyleMap = configStore.get('customBlockStyleMap');\n        var type = contentBlock.getType();\n        if (customBlockStyleMap.hasOwnProperty(type)) {\n            return customBlockStyleMap[type];\n        }\n        return '';\n    };\n\n    EditorCore.prototype.blockRendererFn = function blockRendererFn(contentBlock) {\n        var blockRenderResult = null;\n        this.getPlugins().forEach(function (plugin) {\n            if (plugin.blockRendererFn) {\n                var result = plugin.blockRendererFn(contentBlock);\n                if (result) {\n                    blockRenderResult = result;\n                }\n            }\n        });\n        return blockRenderResult;\n    };\n\n    EditorCore.prototype.eventHandle = function eventHandle(eventName) {\n        var _props2;\n\n        var plugins = this.getPlugins();\n\n        for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key3 = 1; _key3 < _len; _key3++) {\n            args[_key3 - 1] = arguments[_key3];\n        }\n\n        for (var i = 0; i < plugins.length; i++) {\n            var plugin = plugins[i];\n            if (plugin.callbacks[eventName] && typeof plugin.callbacks[eventName] === 'function') {\n                var _plugin$callbacks;\n\n                var result = (_plugin$callbacks = plugin.callbacks)[eventName].apply(_plugin$callbacks, args);\n                if (result === true) {\n                    return 'handled';\n                }\n            }\n        }\n        return this.props.hasOwnProperty(eventName) && (_props2 = this.props)[eventName].apply(_props2, args) === true ? 'handled' : 'not-handled';\n    };\n\n    EditorCore.prototype.generatorEventHandler = function generatorEventHandler(eventName) {\n        var _this7 = this;\n\n        return function () {\n            for (var _len2 = arguments.length, args = Array(_len2), _key4 = 0; _key4 < _len2; _key4++) {\n                args[_key4] = arguments[_key4];\n            }\n\n            return _this7.eventHandle.apply(_this7, [eventName].concat(args));\n        };\n    };\n\n    EditorCore.prototype.customStyleFn = function customStyleFn(styleSet) {\n        if (styleSet.size === 0) {\n            return {};\n        }\n        var plugins = this.getPlugins();\n        var resultStyle = {};\n        for (var i = 0; i < plugins.length; i++) {\n            if (plugins[i].customStyleFn) {\n                var styled = plugins[i].customStyleFn(styleSet);\n                if (styled) {\n                    _extends(resultStyle, styled);\n                }\n            }\n        }\n        return resultStyle;\n    };\n\n    EditorCore.prototype.render = function render() {\n        var _classnames,\n            _this8 = this;\n\n        var _props3 = this.props,\n            prefixCls = _props3.prefixCls,\n            toolbars = _props3.toolbars,\n            style = _props3.style,\n            readOnly = _props3.readOnly,\n            multiLines = _props3.multiLines;\n        var _state = this.state,\n            editorState = _state.editorState,\n            toolbarPlugins = _state.toolbarPlugins;\n\n        var customStyleMap = configStore.get('customStyleMap');\n        var blockRenderMap = configStore.get('blockRenderMap');\n        var eventHandler = this.getEventHandler();\n        var Toolbar = toolbar.component;\n        var cls = classnames((_classnames = {}, _classnames[prefixCls + '-editor'] = true, _classnames.readonly = readOnly, _classnames.oneline = !multiLines, _classnames));\n        return React.createElement(\n            'div',\n            { style: style, className: cls, onClick: this._focus.bind(this) },\n            React.createElement(Toolbar, { editorState: editorState, prefixCls: prefixCls, className: prefixCls + '-toolbar', plugins: toolbarPlugins, toolbars: toolbars }),\n            React.createElement(\n                'div',\n                { className: prefixCls + '-editor-wrapper', ref: function ref(ele) {\n                        return _this8._editorWrapper = ele;\n                    }, style: style, onClick: function onClick(ev) {\n                        return ev.preventDefault();\n                    } },\n                React.createElement(Editor, _extends({}, this.props, eventHandler, { ref: 'editor', customStyleMap: customStyleMap, customStyleFn: this.customStyleFn.bind(this), editorState: editorState, handleKeyCommand: this.handleKeyCommand.bind(this), keyBindingFn: this.handleKeyBinding.bind(this), onChange: this.setEditorState.bind(this), blockStyleFn: this.getBlockStyle.bind(this), blockRenderMap: blockRenderMap, handlePastedText: this.handlePastedText, blockRendererFn: this.blockRendererFn.bind(this) })),\n                readOnly ? React.createElement('input', { style: focusDummyStyle, ref: function ref(ele) {\n                        return _this8._focusDummy = ele;\n                    }, onBlur: eventHandler.onBlur }) : null,\n                this.props.children\n            )\n        );\n    };\n\n    return EditorCore;\n}(React.Component);\n\nEditorCore.GetText = exportText;\nEditorCore.GetHTML = GetHTML(configStore);\nEditorCore.defaultProps = {\n    multiLines: true,\n    plugins: [],\n    prefixCls: 'rc-editor-core',\n    pluginConfig: {},\n    toolbars: [],\n    spilitLine: 'enter'\n};\nEditorCore.childContextTypes = {\n    getEditorState: PropTypes.func,\n    setEditorState: PropTypes.func\n};\nexport default EditorCore;"],"mappings":"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"},"metadata":{},"sourceType":"module"}